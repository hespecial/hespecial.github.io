<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Lu Xiao">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/interview/mysql-interview/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Welcome to My Blog.">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 面试题">
<meta property="og:url" content="http://example.com/Interview/mysql-interview/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Welcome to My Blog.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/common/wall-paper-light.webp">
<meta property="article:published_time" content="2025-02-05T06:28:27.000Z">
<meta property="article:modified_time" content="2025-09-07T10:43:07.953Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Interview">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/common/wall-paper-light.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/other/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/other/favicon.png">
    <meta name="theme-color" content="#000000">
    <link rel="shortcut icon" href="/images/other/favicon.png">
    <!--- Page Info-->
    
    <title>
        
            MySQL 面试题 | Hespecial
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    
        
<script src="/js/build/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":false},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":true,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wall-paper-light.webp","skip_dirs":[]}},"colors":{"primary":"#000000","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":false},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":"Just A Moment"},"open_graph":{"enable":true,"image":"/images/common/wall-paper-light.webp","description":"Welcome to My Blog."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/common/wall-paper-light.webp","dark":"/images/common/wall-paper-dark.webp"},"title":"Hello World","subtitle":{"text":["The Night is Young","The Music is Loud","夜未央","乐未殇"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":60,"backing_speed":40,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":false},"text_color":{"light":"#1f3134","dark":"#eeeeee"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"center","links":{"github":"https://github.com/hespecial","instagram":null,"zhihu":null,"twitter":null,"email":"1478488313@qq.com"},"qrs":{"weixin":"/images/other/weixin-qrcode.jpeg","qq":"/images/other/qq-qrcode.jpeg"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#ffffff","right":"#000000","transparency":35},"width":{"home":"1200px","pages":"1200px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"Album":{"path":"/album","icon":"fa-solid fa-image"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":false,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"YYYY-MM-DD","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/1/16 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        Just A Moment
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Hespecial
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    TAGS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    CATEGORIES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/album"
                                        >
                                    <i class="fa-solid fa-image fa-fw"></i>
                                    ALBUM
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                TAGS
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                CATEGORIES
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/album"
                        >
                            <span>
                                ALBUM
                            </span>
                            
                                <i class="fa-solid fa-image fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">3</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">3</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">11</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">MySQL 面试题</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/common/avatar.jpeg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Lu Xiao</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-02-05 Wednesday</span>
        <span class="mobile">2025-02-05 Wednesday</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-09-07 Sunday</span>
            <span class="mobile">2025-09-07 Sunday</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Interview/">Interview</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Interview/">Interview</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>12.1k Words</span>
        </span>
    
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="基础部分"><a href="#基础部分" class="headerlink" title="基础部分"></a>基础部分</h1><h2 id="MySQL数据类型"><a href="#MySQL数据类型" class="headerlink" title="MySQL数据类型"></a>MySQL数据类型</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <div class="tabs" id="tab-first"><ul class="nav-tabs"><li class="tab active"><a class="#first-1">数值类型</a></li><li class="tab"><a class="#first-2">日期时间类型</a></li><li class="tab"><a class="#first-3">字符串类型</a></li></ul><div class="tab-content"><div class="tab-pane active" id="first-1"><ul><li><strong>整数类型</strong>：<ul><li><code>TINYINT</code>：1 字节</li><li><code>SMALLINT</code>：2 字节</li><li><code>MEDIUMINT</code>：3 字节</li><li><code>INT</code> 或 <code>INTEGER</code>：4 字节</li><li><code>BIGINT</code>：8 字节</li></ul></li><li><strong>浮点数类型</strong>：<ul><li><code>FLOAT</code>：4 字节</li><li><code>DOUBLE</code>：8 字节</li></ul></li><li><strong>定点数类型</strong>：<ul><li><code>DECIMAL(M, D)</code>：精确小数，M 为总位数，D 为小数位数。</li></ul></li></ul></div><div class="tab-pane" id="first-2"><ul><li><code>DATE</code>：日期，格式为 <code>YYYY-MM-DD</code>。</li><li><code>TIME</code>：时间，格式为 <code>HH:MM:SS</code>。</li><li><code>DATETIME</code>：日期和时间，格式为 <code>YYYY-MM-DD HH:MM:SS</code>。</li><li><code>TIMESTAMP</code>：时间戳，范围从 <code>1970-01-01 00:00:01</code> UTC 到 <code>2038-01-19 03:14:07</code> UTC。</li><li><code>YEAR</code>：年份，格式为 <code>YYYY</code>。</li></ul></div><div class="tab-pane" id="first-3"><ul><li><strong>常用</strong>：<ul><li><code>CHAR(M)</code>：固定长度字符串，M 为字符数，最多 255 个字符。</li><li><code>VARCHAR(M)</code>：可变长度字符串，M 为最大字符数，最多 65535 个字符。</li></ul></li><li><strong>文本类型</strong>：<ul><li><code>TINYTEXT</code>：最大长度 255 个字符。</li><li><code>TEXT</code>：最大长度 65535 个字符。</li><li><code>MEDIUMTEXT</code>：最大长度 16777215 个字符。</li><li><code>LONGTEXT</code>：最大长度 4294967295 个字符。</li></ul></li><li><strong>二进制大对象（BLOB）</strong>：<ul><li><code>TINYBLOB</code>：最大长度 255 字节。</li><li><code>BLOB</code>：最大长度 65535 字节。</li><li><code>MEDIUMBLOB</code>：最大长度 16777215 字节。</li><li><code>LONGBLOB</code>：最大长度 4294967295 字节。</li></ul></li></ul></div></div></div>
              </div>
            </details>

<h2 id="CHAR和VARCHAR的区别"><a href="#CHAR和VARCHAR的区别" class="headerlink" title="CHAR和VARCHAR的区别"></a>CHAR和VARCHAR的区别</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>主要区别</strong><ul><li>CHAR 是定长的</li><li>VARCHAR 是变长的</li><li>效率上CHAR更高</li></ul></li><li><strong>存储和检索方式</strong><ul><li>CHAR 在存储时会在右边填充空格以达到指定的长度，检索时会去掉空格</li><li>VARCHAR 在存储时需要使用 1 或 2 个额外字节记录字符串的长度，检索时不需要处理</li></ul></li><li><strong>使用场景</strong><ul><li>CHAR 更适合存储长度较短或者长度都差不多的字符串，例如 Bcrypt 算法、MD5 算法加密后的密码、身份证号码</li><li>VARCHAR 适合存储长度不确定或者差异较大的字符串，例如用户昵称、文章标题等。</li></ul></li></ul>
              </div>
            </details>

<h2 id="DATETIME-和-TIMESTAMP-的区别是什么"><a href="#DATETIME-和-TIMESTAMP-的区别是什么" class="headerlink" title="DATETIME 和 TIMESTAMP 的区别是什么"></a>DATETIME 和 TIMESTAMP 的区别是什么</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>格式区别</strong><ul><li>TIMESTAMP 和时区有关</li><li>DATETIME 类型没有时区信息</li></ul></li><li><strong>存储大小</strong><ul><li>TIMESTAMP 使用 4 个字节的存储空间</li><li>DATETIME 使用 8 个字节的存储空间</li></ul></li><li><strong>表示范围</strong><ul><li>TIMESTAMP：1970-01-01 00:00:01 ~ 2037-12-31 23:59:59</li><li>DATETIME：1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</li></ul></li></ul>
              </div>
            </details>

<h2 id="三大范式"><a href="#三大范式" class="headerlink" title="三大范式"></a>三大范式</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>第一范式（1NF）</strong><ul><li>字段（或属性）是不可分割的最小单元，即不会有重复的列，体现原子性</li></ul></li><li><strong>第二范式（2NF）</strong><ul><li>满足 1NF 前提下，存在一个候选码，非主属性全部依赖该候选码，即存在主键，体现唯一性，专业术语则是消除部分函数依赖</li><li>假如学生表主键是（学生id，课程id），很明显可以通过主键推出学生姓名，但是实际上只需要学生id一个属性就可以推出学生姓名，主键只需要保留学生id即可</li></ul></li><li><strong>第三范式（3NF）</strong><ul><li>满足 2NF 前提下，非主属性必须互不依赖，消除传递依赖</li><li>假如员工表员工id为主键，员工id可以推出部门id，部门id又能推出部门名称，那么员工id推出部门名称这一关系就不能出现在同一张表中</li></ul></li></ul>
              </div>
            </details>

<h2 id="INT-n-中的n如何理解"><a href="#INT-n-中的n如何理解" class="headerlink" title="INT(n)中的n如何理解"></a>INT(n)中的n如何理解</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong><code>n</code> 是显示宽度</strong>，不是存储位数或范围</li><li>如果没有使用 <code>ZEROFILL</code>，<code>n</code> 的作用可以忽略</li><li><code>INT(n)</code> 的存储空间和范围与 <code>n</code> 无关</li></ul>
              </div>
            </details>

<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><h2 id="事务的特性"><a href="#事务的特性" class="headerlink" title="事务的特性"></a>事务的特性</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>原子性（Atomicity）</strong><ul><li>事务中的所有操作要么全部完成，要么全部不完成，不会结束在中间某个点。这意味着事务是一个不可分割的工作单元。</li></ul></li><li><strong>一致性（Consistency）</strong><ul><li>事务必须保证数据库从一个一致的状态转移到另一个一致的状态。事务执行的结果必须符合所有预定义的规则和约束。</li></ul></li><li><strong>隔离性（Isolation）</strong><ul><li>并发执行的事务之间不会互相影响。每个事务都像是在系统上独立运行，即使有多个事务同时进行，它们也应该是隔离的，以防止数据损坏。</li></ul></li><li><strong>持久性（Durability）</strong><ul><li>一旦事务提交，它对数据库的改变就是永久性的，即使系统发生故障，这些改变也不会丢失。</li></ul></li></ul>
              </div>
            </details>

<h2 id="并发事务的问题"><a href="#并发事务的问题" class="headerlink" title="并发事务的问题"></a>并发事务的问题</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>脏读（Dirty Read）</strong><ul><li>一个事务读取了另一个事务未提交的数据。如果那个事务最终回滚了，那么读取的数据就是无效的。</li></ul></li><li><strong>不可重复读（Non-repeatable Read）</strong><ul><li>在一个事务中，多次读取同一数据集合时，由于其他事务的介入，可能会得到不同的结果。这种情况通常发生在读已提交或更低的隔离级别。</li></ul></li><li><strong>幻读（Phantom Read）</strong><ul><li>在同一事务中，当同一个查询在不同的时间产生不同的结果集时，事务中就会出现所谓的幻象问题。</li></ul></li></ul>
              </div>
            </details>

<h2 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别"></a>事务的隔离级别</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>读未提交（Read Uncommitted）</strong><ul><li>事务可以读取到其他未提交事务的更改</li><li>可能导致脏读，即读取到其他事务未提交的数据</li></ul></li><li><strong>读已提交（Read Committed）</strong><ul><li>事务只能读取到其他事务已经提交的更改，避免了脏读</li><li>但可能遇到不可重复读的问题，即在同一事务中，由于其他事务的更新，两次读取到的数据不一致。</li></ul></li><li><strong>可重复读（Repeatable Read）</strong><ul><li>事务在整个过程中可以看到一致的快照数据，解决了不可重复读的问题</li><li>但是不能防止幻读，即在同一事务中，同一个查询在不同的时间产生不同的结果集</li></ul></li><li><strong>串行化（Serializable）</strong><ul><li>最高的隔离级别，通过完全串行化执行事务来避免脏读、不可重复读和幻读</li><li>在这个级别，事务将被序列化，依次单独执行，从而提供了最严格的隔离</li><li>但是这也可能导致较慢的性能</li></ul></li></ul><blockquote><p><em><strong>Tip</strong></em></p><p>MySQL InnoDB 引擎的默认隔离级别虽然是「可重复读」，但是它很大程度上避免了幻读现象</p><ul><li>针对快照读（普通 select 语句），是通过 MVCC 方式解决了幻读，因为可重复读隔离级别下，事务执行过程中看到的数据，一直跟这个事务启动时看到的数据是一致的，即使中途有其他事务插入了一条数据，是查询不出来这条数据的，所以就很好了避免幻读问题</li><li>针对当前读（select … for update 等语句），是通过 next-key lock（记录锁+间隙锁）方式解决了幻读，因为当执行 select … for update 语句的时候，会加上 next-key lock，如果有其他事务在 next-key lock 锁范围内插入了一条记录，那么这个插入语句就会被阻塞，无法成功插入，所以就很好了避免幻读问题</li></ul><p>但是如果同时存在快照读和当前读，那么依然会存在幻读的问题</p></blockquote>
              </div>
            </details>

<h2 id="四种隔离级别是如何实现的"><a href="#四种隔离级别是如何实现的" class="headerlink" title="四种隔离级别是如何实现的"></a>四种隔离级别是如何实现的</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>读未提交</strong><ul><li>直接读取最新的数据</li></ul></li><li><strong>串行化</strong><ul><li>通过加读写锁的方式来避免并行访问</li></ul></li><li><strong>读已提交&amp;可重复读</strong><ul><li>它们是通过 Read View 来实现的，它们的区别在于<strong>创建 Read View 的时机不同</strong></li><li>读已提交是在<strong>每次读取数据时</strong>重新生成一个 Read View</li><li>可重复读是在<strong>启动事务时</strong>生成一个 Read View，然后整个事务期间都在用这个 Read View</li></ul></li></ul>
              </div>
            </details>

<h2 id="Read-View的实现原理"><a href="#Read-View的实现原理" class="headerlink" title="Read View的实现原理"></a>Read View的实现原理<a id="readview"></a></h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <div class="tabs" id="tab-second"><ul class="nav-tabs"><li class="tab active"><a class="#second-1">数据结构</a></li><li class="tab"><a class="#second-2">工作原理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="second-1"><ul><li>Read View本质上是一个<strong>保存事务ID的列表</strong></li><li><strong>四个重要字段</strong><ul><li>m_ids：创建 Read View 时，当前数据库中「活跃事务」的事务 id 列表，注意是一个列表，「活跃事务」指的是启动了但还没提交的事务</li><li>min_trx_id：在创建 Read View 时，当前数据库中「活跃事务」中事务 id 最小的事务，也就是 m_ids 的最小值</li><li>max_trx_id：这个并不是 m_ids 的最大值，而是创建 Read View 时当前数据库中应该给下一个事务的 id 值，也就是全局事务中最大的事务 id 值 + 1</li><li>creator_trx_id ：指的是创建该 Read View 的事务的事务 id</li></ul></li><li><strong>两个隐藏字段</strong><ul><li>trx_id：当一个事务对某条聚簇索引记录进行改动时，就会把该事务的事务 id 记录在 trx_id 隐藏列里</li><li>roll_pointer：每次对某条聚簇索引记录进行改动时，都会把旧版本的记录写入到 undo log中，这个隐藏列是个指针，指向每一个旧版本记录，于是就可以通过它找到修改前的记录</li></ul></li></ul></div><div class="tab-pane" id="second-2"><ul><li>一个事务去访问记录时，自己的更新记录总是可见的</li><li>如果记录的 trx_id 值小于 Read View 中的 min_trx_id 值，表示这个版本的记录是在创建 Read View 前已经提交的事务生成的，所以该版本的记录对当前事务可见</li><li>如果记录的 trx_id 值大于等于 Read View 中的 max_trx_id 值，表示这个版本的记录是在创建 Read View 后才启动的事务生成的，所以该版本的记录对当前事务不可见</li><li>如果记录的 trx_id 值在 Read View 的 min_trx_id 和 max_trx_id 之间，需要判断 trx_id 是否在 m_ids 列表中<ul><li>如果记录的 trx_id 在 m_ids 列表中，表示生成该版本记录的活跃事务依然活跃着（还没提交事务），所以该版本的记录对当前事务不可见。</li><li>如果记录的 trx_id 不在 m_ids列表中，表示生成该版本记录的活跃事务已经被提交，所以该版本的记录对当前事务可见</li></ul></li></ul><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/post/read-view.png"
                      alt="read-view"
                ></p></div></div></div>
              </div>
            </details>

<h2 id="事务是如何实现的"><a href="#事务是如何实现的" class="headerlink" title="事务是如何实现的"></a>事务是如何实现的</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>实现事务就是要实现事务的<strong>四大特性ACID</strong><ul><li><a href="#undo">原子性通过undo log保证</a></li><li><a href="#redo">持久性通过redo log保证</a></li><li>隔离性通过锁和MVCC保证</li><li>一致性由原子性、持久性、隔离性共同保证</li></ul></li></ul>
              </div>
            </details>

<h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><h2 id="如何选择存储引擎"><a href="#如何选择存储引擎" class="headerlink" title="如何选择存储引擎"></a>如何选择存储引擎</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>InnoDB</strong><ul><li>需要事务（如支付系统）</li><li>高并发写入（如电商订单）</li><li>要求数据完整性和崩溃恢复</li></ul></li><li><strong>MyISAM</strong><ul><li>读多写少（如新闻网站的文章表）</li></ul></li><li><strong>MEMORY</strong><ul><li>临时数据或缓存（如会话存储）</li></ul></li></ul>
              </div>
            </details>

<h2 id="InnoDB和MyISAM的区别"><a href="#InnoDB和MyISAM的区别" class="headerlink" title="InnoDB和MyISAM的区别"></a>InnoDB和MyISAM的区别</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/post/mysql-innodb-vs-myisam.png"
                      alt="innodb-vs-myisam"
                ></p>
              </div>
            </details>

<h2 id="如何优化InnoDB的性能"><a href="#如何优化InnoDB的性能" class="headerlink" title="如何优化InnoDB的性能"></a>如何优化InnoDB的性能</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>调整缓冲池大小<ul><li>增加缓存以减少磁盘I&#x2F;O</li></ul></li><li>调整日志文件大小<ul><li>由于Redo Log采用WAL（Write-Ahead Logging）机制，先写日志再更新数据，日志文件大小决定了更新数据的频率</li></ul></li></ul>
              </div>
            </details>

<h2 id="为什么InnoDB在并发写入时性能更好"><a href="#为什么InnoDB在并发写入时性能更好" class="headerlink" title="为什么InnoDB在并发写入时性能更好"></a>为什么InnoDB在并发写入时性能更好</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>行级锁</strong><ul><li>仅锁定涉及的行，其他行仍可操作，减少锁冲突</li></ul></li><li><strong>MVCC（多版本并发控制）</strong><ul><li>通过版本链实现非阻塞读，读写操作互不阻塞</li></ul></li></ul>
              </div>
            </details>

<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><h2 id="索引的分类"><a href="#索引的分类" class="headerlink" title="索引的分类"></a>索引的分类</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><p>数据结构上分为</p><ul><li>B+树索引</li><li>哈希索引</li></ul></li><li><p>物理结构上分为</p><ul><li>聚集索引</li><li>二级索引</li></ul></li><li><p>应用上分为：</p><ul><li>主键索引</li><li>普通索引</li><li>唯一索引</li><li>联合索引</li><li>全文索引</li></ul></li></ul>
              </div>
            </details>

<h2 id="索引的优缺点"><a href="#索引的优缺点" class="headerlink" title="索引的优缺点"></a>索引的优缺点</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><p>优点</p><ul><li>加快数据的检索速度</li><li>加快表和表之间的连接速度</li><li>可以显著减少查询中分组和排序的时间</li></ul></li><li><p>缺点</p><ul><li>创建和维护索引需要耗费时间，这种时间随着数据量的增加而增加，这样就降低了数据的维护速度</li><li>索引需要占物理空间，本质上是空间换时间</li></ul></li></ul>
              </div>
            </details>

<h2 id="索引的设计原则"><a href="#索引的设计原则" class="headerlink" title="索引的设计原则"></a>索引的设计原则</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>什么时候需要创建索引<ul><li>对于很大的表且存在频繁用于查询条件的列，考虑建立索引提高查询速度</li><li>具有唯一性的数据可以创建索引，可以更快速的通过该索引来确定某条记录</li><li>频繁使用排序、分组和联合操作的列，执行这些操作时，排序操作会浪费很多时间。如果为其建立索引，可以有效地避免排序操作</li></ul></li><li>什么时候不需要创建索引<ul><li>小表不建议索引，由于数据较小，直接查询花费的时间可能比遍历索引的时间还要短，索引可能不会产生优化效果</li><li>经常进行更新的字段不需要创建索引，这样会破环B+树的结构，重新调整的开销大</li><li>区分度不高的字段，一般不需要单独创建索引，比如性别字段</li></ul></li></ul><blockquote><p><em><strong>Tip</strong></em><br>大表和小表的评判标准是什么？</p><ul><li>从数据上来说，一般几千行数据的表为小表，几万或几十万行数据的表为大表</li><li>从业务场景上来说，如果一张表每秒要查询上千次，那么即使这张表只有几千行数据，那我们也最好加上索引</li></ul></blockquote>
              </div>
            </details>

<h2 id="B树和B-树的区别"><a href="#B树和B-树的区别" class="headerlink" title="B树和B+树的区别"></a>B树和B+树的区别</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>数据存储位置</strong>：<ul><li><strong>B树</strong>：所有节点都存储数据，包括内部节点和叶子节点。</li><li><strong>B+树</strong>：仅叶子节点存储数据，内部节点只存储键值，用于索引。</li></ul></li><li><strong>叶子节点结构</strong>：<ul><li><strong>B树</strong>：叶子节点独立，不相互连接。</li><li><strong>B+树</strong>：叶子节点通过指针相连，形成有序链表，便于范围查询。</li></ul></li><li><strong>查询效率</strong>：<ul><li><strong>B树</strong>：由于数据分布在所有节点，查询时间不稳定，可能很快找到数据，也可能需要遍历多层。</li><li><strong>B+树</strong>：查询路径长度固定，必须到达叶子节点，因此查询时间更稳定。</li></ul></li></ul>
              </div>
            </details>

<h2 id="B-树为什么比B树更适合用与数据库索引"><a href="#B-树为什么比B树更适合用与数据库索引" class="headerlink" title="B+树为什么比B树更适合用与数据库索引"></a>B+树为什么比B树更适合用与数据库索引</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>B+ 树减少了 IO 次数</strong><ul><li>由于索引文件很大因此索引文件存储在磁盘上，B+ 树的非叶子结点只存关键字不存数据，因而单个页可以存储更多的关键字，即一次性读入内存的需要查找的关键字也就越多，磁盘的随机 I&#x2F;O 读取次数相对就减少了。</li></ul></li><li><strong>B+ 树查询效率更稳定</strong><ul><li>由于B+树数据只存在在叶子结点上，所以查找效率固定为 O(log n)，而B树的数据分布在所有节点，查询时间存在抖动，所以 B+ 树的查询效率相比B树更加稳定。</li></ul></li><li><strong>B+ 树更加适合范围查找</strong><ul><li>B+ 树叶子结点之间用链表有序连接，所以扫描全部数据只需扫描一遍叶子结点，利于扫库和范围查询；B 树由于非叶子结点也存数据，所以只能通过中序遍历按序来扫。也就是说，对于范围查询和有序遍历而言，B+ 树的效率更高。</li></ul></li></ul>
              </div>
            </details>

<h2 id="B-树相对于二叉树和Hash的优势"><a href="#B-树相对于二叉树和Hash的优势" class="headerlink" title="B+树相对于二叉树和Hash的优势"></a>B+树相对于二叉树和Hash的优势</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>相对于二叉树，B+树的层数更少，查询效率更高</li><li>相对于Hash，B+树支持范围匹配和排序操作</li></ul>
              </div>
            </details>

<h2 id="B-树查询数据的过程"><a href="#B-树查询数据的过程" class="headerlink" title="B+树查询数据的过程"></a>B+树查询数据的过程</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>定位根节点<ul><li>从根节点开始，通过二分法快速定位到符合页内范围包含查询值的页</li></ul></li><li>内部节点遍历<ul><li>在内部节点中，继续定位到合适的子节点，并移动到该子节点，循环此过程直至到达叶子节点</li></ul></li><li>叶子节点遍历<ul><li>在叶子节点中，由于数据已排序，可以直接使用二分查找或顺序查找定位到具体的数据记录</li></ul></li></ul>
              </div>
            </details>

<h2 id="最左匹配原则"><a href="#最左匹配原则" class="headerlink" title="最左匹配原则"></a>最左匹配原则</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>最左匹配原则主要用来处理使用联合索引时可能出现的一些问题</li><li>最左匹配原则要求查询条件中的列应该从索引的最左边的列开始，并且不能跳过中间的列</li><li>如果查询条件不按照索引的顺序进行匹配，那么索引可能会失效或者部分失效</li></ul>
              </div>
            </details>

<h2 id="回表查询和覆盖索引"><a href="#回表查询和覆盖索引" class="headerlink" title="回表查询和覆盖索引"></a>回表查询和覆盖索引</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>回表查询</strong><ul><li>因为二级索引只有索引和id字段的信息，如果要获取到其他字段，就需要通过id字段到聚簇索引中再次查询，这个过程就叫回表查询</li></ul></li><li><strong>覆盖索引</strong><ul><li>将select中的列包含在索引之中，这样在查找时就可以直接返回对应的字段信息，避免了回表查询</li></ul></li></ul>
              </div>
            </details>

<h2 id="前缀索引"><a href="#前缀索引" class="headerlink" title="前缀索引"></a>前缀索引</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>原理</strong><ul><li>对于较长的文本字段，直接对整个字段创建索引会占用大量存储空间，并且索引维护的开销较大。</li><li>前缀索引只对字段的前 <code>N</code> 个字符创建索引，从而减少索引大小，节省空间并提高查询效率。</li><li>例如，对 <code>desc VARCHAR(255)</code> 的字段，可以只对前 10 个字符创建索引<code>CREATE INDEX index_name ON table_name (desc(10))</code>。</li></ul></li><li><strong>注意事项</strong><ul><li><strong>区分度不足</strong>：如果前缀长度过短，可能导致大量重复值，降低查询效率。</li><li><strong>查询条件匹配</strong>：查询条件必须使用前缀匹配（如 <code>LIKE &#39;abc%&#39;</code>），否则无法利用前缀索引。</li><li><strong>排序和分组</strong>：前缀索引不支持 <code>ORDER BY</code> 和 <code>GROUP BY</code> 操作。</li><li><strong>覆盖索引</strong>：前缀索引无法覆盖查询，因为只索引了部分字段。</li></ul></li></ul>
              </div>
            </details>

<h2 id="索引下推"><a href="#索引下推" class="headerlink" title="索引下推"></a>索引下推</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>在使用非主键索引进行查询时，如果索引列中存在某些判断条件时，会优先通过这些判断条件过滤掉不满足条件的数据，之后再进行回表操作进一步确定满足条件的数据</li><li>可以有效减少回表查询的次数，大大提升查询的效率</li></ul>
              </div>
            </details>

<h2 id="索引失效的情况"><a href="#索引失效的情况" class="headerlink" title="索引失效的情况"></a>索引失效的情况</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>违背最左匹配原则</li><li>查询条件中有or时只要有一个条件没有索引，整个sql就不走索引</li><li>like模糊查询使用前导通配符，导致索引无法定位起始点</li><li>对索引列使用了函数或运算，数据库无法直接使用原始索引值</li><li>字段类型不匹配时，数据库需要隐式转换类型，相当于使用了函数</li><li>使用in时列表过长或子查询结果集过大时优化器可能判断全表扫描比多次索引查找更高效</li></ul>
              </div>
            </details>

<h2 id="索引优化"><a href="#索引优化" class="headerlink" title="索引优化"></a>索引优化</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>选择合适的索引类型和列</strong><ul><li>单列索引</li><li>复合索引</li><li>全文索引</li></ul></li><li><strong>避免索引失效和冗余</strong><ul><li>见索引失效的情况</li><li>删除重复或冗余的索引，如果已有索引 <code>(a, b)</code>，则索引 <code>(a)</code> 可能是冗余的</li></ul></li><li><strong>合理利用覆盖索引和前缀索引</strong><ul><li>见覆盖索引和前缀索引</li></ul></li></ul>
              </div>
            </details>

<h1 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h1><h2 id="MySQL锁的类型"><a href="#MySQL锁的类型" class="headerlink" title="MySQL锁的类型"></a>MySQL锁的类型</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <div class="tabs" id="tab-third"><ul class="nav-tabs"><li class="tab active"><a class="#third-1">全局锁</a></li><li class="tab"><a class="#third-2">表级锁</a></li><li class="tab"><a class="#third-3">行级锁</a></li></ul><div class="tab-content"><div class="tab-pane active" id="third-1"><ul><li><p><strong>作用</strong></p><ul><li>使<strong>整个数据库</strong>处于<strong>只读状态</strong></li></ul></li><li><p><strong>使用方法</strong></p><ul><li>开启全局锁：<code>flush tables with read lock</code></li><li>释放全局锁：<code>unlock tables</code></li></ul></li><li><p><strong>优缺点</strong></p><ul><li>开启全局锁后所有对数据的修改操作都不允许，保证了数据的一致性，适合做全库逻辑备份</li><li>全局锁开启期间，所有写操作都会被阻塞，容易导致业务停滞</li></ul></li></ul><blockquote><p><em><strong>Tip</strong></em></p><p>如果数据库的存储引擎支持事务的可重复读隔离级别，那么就可以避免全局锁导致的写操作阻塞，因为在可重复读的隔离级别下，即使其他事务更新了表的数据，也不会影响备份数据库时的 Read View</p></blockquote></div><div class="tab-pane" id="third-2"><ul><li><strong>表锁</strong><ul><li>锁定整张表</li><li>通过 <code>LOCK TABLES table_name READ/WRITE</code> 添加表级共享锁（读锁）&#x2F;独占锁（写锁）</li><li>读锁允许其他事务读取表，但阻止写操作；写锁阻止其他事务的读、写操作。</li></ul></li><li><strong>元数据锁</strong><ul><li><strong>保护表结构，防止在表结构变更时进行读写操作，反之亦然</strong></li><li>对数据库表进行操作时，会自动给这个表加上 MDL，在<strong>事务提交后才会释放</strong><ul><li>对一张表进行 CRUD 操作时，加的是 MDL 读锁</li><li>对一张表做结构变更操作的时候，加的是 MDL 写锁</li></ul></li></ul></li><li><strong>意向锁</strong><ul><li><strong>用来快速判断表里是否有记录被加锁</strong></li><li>也分为<strong>意向共享锁</strong>和<strong>意向独占锁</strong></li><li>意向共享锁和意向独占锁是表级锁，不会和行级的共享锁和独占锁发生冲突，而且意向锁之间也不会发生冲突，只会和共享表锁<code>lock tables ... read</code>或独占表锁发<code>lock tables ... write</code>生冲突</li><li>因为在使用 InnoDB 引擎的表里对某些记录加上「共享锁&#x2F;独占锁」之前，需要先在表级别加上一个「意向共享锁&#x2F;意向独占锁」，那么再给表加「独占表锁」时，会先检查该表是否存在「意向共享锁&#x2F;意向独占锁」，如果有就意味着表里已经有记录被加了「共享锁&#x2F;独占锁」，这样就避免了加「独占表锁」时去遍历全部数据来判断表里是否有记录被加了锁</li></ul></li><li><strong>自增锁</strong><ul><li>保证被<code>AUTO_INCRMENT</code>修饰的字段是连续递增的</li><li>在插入数据时会加一个自增锁，插入操作执行完毕后立即释放，而不必等待整个事务提交才释放</li></ul></li></ul></div><div class="tab-pane" id="third-3"><ul><li><strong>记录锁</strong><ul><li>锁住的是一条记录</li></ul></li><li><strong>间隙锁</strong><ul><li>锁住的是两条记录之间的间隙，存在于RR隔离级别，防止其他事务在这个间隙进行INSERT操作，目的是为了解决幻读的现象</li></ul></li><li><strong>临键锁</strong><ul><li>锁住的是一个范围，并且包括记录本身（左闭右开区间），相当于记录锁+临键锁，存在于RR隔离级别，也是为了解决幻读的现象</li></ul></li><li><strong>插入意向锁</strong><ul><li><p>一种特殊的间隙锁，属于行级别锁</p><ul><li>假设事务 A 已经对表加了一个范围 id 为（3，5）间隙锁，当事务 A 还没提交的时候，事务 B 向该表插入一条 id &#x3D; 4 的新记录，这时会判断到插入的位置已经被事务 A 加了间隙锁，于是事物 B 会生成一个插入意向锁，然后将锁的状态设置为等待状态，此时事务 B 就会发生阻塞，直到事务 A 提交了事务</li><li>如果锁状态是等待状态，并不是意味着事务成功获取到了锁，只有当锁状态为正常状态时，才代表事务成功获取到了锁</li></ul></li><li><p>尽管「插入意向锁」也属于间隙锁，但两个事务却不能在同一时间内，一个拥有间隙锁，另一个拥有该间隙区间内的插入意向锁（当然，插入意向锁如果不在间隙锁区间内则是可以的）</p></li></ul></li></ul></div></div></div>
              </div>
            </details>

<h2 id="MySQL是如何加行级锁的"><a href="#MySQL是如何加行级锁的" class="headerlink" title="MySQL是如何加行级锁的"></a>MySQL是如何加行级锁的</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>MySQL加锁的对象是索引，加锁的基本单位是「临键锁」</li><li>唯一索引加锁只加在唯一索引项上；非唯一索引加锁同时加在普通索引项和主键索引项上；不走索引会给所有记录加锁，相当于锁住全表</li><li>但是某些的场景下，「临键锁」会退化成「记录锁」或「间隙锁」</li></ul><div class="tabs" id="tab-fourth"><ul class="nav-tabs"><li class="tab active"><a class="#fourth-1">唯一索引</a></li><li class="tab"><a class="#fourth-2">非唯一索引</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fourth-1"><ul><li><strong>等值查询</strong><ul><li>当查询的记录是「存在」的，该记录索引的「临键锁」会退化成「记录锁」</li><li>当查询的记录是「不存在」的，先找到第一条大于该记录的记录，该记录索引的「临键锁」会退化成「间隙锁」</li></ul></li><li><strong>范围查询</strong><ul><li>针对「大于」或「大于等于」的范围查询<ul><li>如果边界记录不在表中<ul><li>不管是「大于」还是「大于等于」，会对每一个扫描到的索引项加「临键锁」</li></ul></li><li>如果边界记录存在于表中<ul><li>对于「大于」，依然对每一个扫描到的索引项加「临键锁」</li><li>对于「大于等于」，该边界记录索引的「临键锁」会退化成「记录锁」，其他扫描到的索引项加「临键锁」</li></ul></li></ul></li><li>针对「小于」或「小于等于」的范围查询<ul><li>如果边界记录不在表中<ul><li>不管是「小于」还是「小于等于」，先找到第一条大于该记录的记录，该记录索引的「临键锁」锁会退化成「间隙锁」，其他扫描到的索引项加「临键锁」</li></ul></li><li>如果边界记录存在于表中<ul><li>对于「小于」，边界记录索引的「临键锁」会退化成「间隙锁」，其他扫描到的索引项加「临键锁」</li><li>对于「小于等于」，直接对每一个扫描到的索引项加「临键锁」</li></ul></li></ul></li></ul></li></ul></div><div class="tab-pane" id="fourth-2"><ul><li><strong>等值查询</strong><ul><li>记录「存在」时，首先对该记录主键索引加「记录锁」，然后扫描寻找符合条件的记录，对这些记录的二级索引加「临键锁」，最后找到第一个不符合条件终止记录，对终止记录加「间隙锁」</li><li>记录「不存在」时，扫描找到第一个不符合条件终止记录，对该记录加「间隙锁」</li></ul></li><li><strong>范围查询</strong><ul><li>对所有扫描到的索引项，不管是主键索引还是二级索引，都加「临键锁」，不存在「临键锁」退化的情况</li></ul></li></ul></div></div></div>
              </div>
            </details>

<h2 id="MySQL死锁"><a href="#MySQL死锁" class="headerlink" title="MySQL死锁"></a>MySQL死锁</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>死锁是指在两个或多个事务在执行过程中，因争夺资源而互相等待的现象。简单来说，就是事务A等待事务B释放资源，而事务B又在等待事务A释放资源，最终导致双方都无法完成。</li><li><strong>解决死锁的方法</strong><ul><li>设置事务等待锁的超时时间。当一个事务的等待时间超过该值后，就对这个事务进行回滚，于是锁就释放了，另一个事务就可以继续执行了。</li><li>开启主动死锁检测。主动死锁检测在发现死锁后，主动回滚死锁链条中的某一个事务，让其他事务得以继续执行。</li></ul></li></ul>
              </div>
            </details>

<h2 id="乐观锁和悲观锁"><a href="#乐观锁和悲观锁" class="headerlink" title="乐观锁和悲观锁"></a>乐观锁和悲观锁</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <div class="tabs" id="tab-fifth"><ul class="nav-tabs"><li class="tab active"><a class="#fifth-1">乐观锁</a></li><li class="tab"><a class="#fifth-2">悲观锁</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fifth-1"><ul><li><strong>原理</strong><ul><li>乐观锁假设数据冲突较少，所以在读取数据时不会加锁，而是在更新数据时通过版本号或时间戳来检测数据是否被其他事务修改，常见的实现方式是在数据表中增加一个版本号（version）字段，更新时同时检查版本号是否与之前读取的一致，如果受影响的行数为0，则说明数据在此期间被其他事务修改，更新操作就会失败，应用程序可以选择重新读取数据并重试。</li></ul></li><li><strong>特点</strong><ul><li><strong>高并发性能</strong>：读操作时无需加锁，降低了锁竞争，适合高并发场景。</li><li><strong>冲突检测</strong>：通过版本号等机制在更新时检测数据冲突，确保数据一致性。</li><li><strong>冲突处理</strong>：当冲突发生时需要应用程序层面处理，比如重试或报错，业务逻辑可能因此复杂化。</li></ul></li><li><strong>适用场景</strong><ul><li>系统读多写少的场景或者并发冲突较少的应用。</li><li>业务场景允许在冲突发生时进行重试或补救措施。</li></ul></li></ul></div><div class="tab-pane" id="fifth-2"><ul><li><strong>原理</strong><ul><li>悲观锁假设数据竞争会频繁发生，因此在每次操作数据时都会先对数据进行加锁。比如在使用InnoDB存储引擎时，可以通过 <code>SELECT ... FOR UPDATE</code> 对查询到的记录加排他锁，从而防止其他事务对这些记录进行修改。</li></ul></li><li><strong>特点</strong><ul><li><strong>严格控制并发</strong>：在加锁期间，其他事务无法修改甚至读取被锁定的数据（根据锁类型不同，可能允许读操作，但通常都是锁住写操作）。</li><li><strong>数据安全性高</strong>：适合在竞争激烈、数据一致性要求高的场景下使用。</li><li><strong>性能开销</strong>：由于需要频繁加锁和解锁，且锁会导致事务等待，可能降低并发性能。</li></ul></li><li><strong>适用场景</strong><ul><li>写操作频繁且冲突可能性较高的系统。</li><li>对数据一致性要求非常严格、容忍较低并发的业务场景。</li></ul></li></ul></div></div></div>
              </div>
            </details>

<h1 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h1><h2 id="MySQL中常见的日志"><a href="#MySQL中常见的日志" class="headerlink" title="MySQL中常见的日志"></a>MySQL中常见的日志</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>回滚日志（Undo Log）</strong>： 保存了事务发生之前的数据的一个版本，作用是通过回滚<strong>保证事务的原子性</strong>和<strong>配合Read View实现MVCC</strong>。</li><li><strong>重做日志（Redo Log）：</strong>：记录了事务执行后的状态，用来恢复未写入 data file 的已提交事务数据，作用是用于掉电等故障的恢复，以<strong>确保事务的持久性</strong>。</li><li><strong>二进制日志（Bin Log）</strong>：Server 层生成的日志，主要<strong>用于数据备份和主从复制</strong>；</li><li><strong>普通查询日志（General Query Log）</strong>：记录了服务器接收到的每一个命令，无论命令语句是否正确，因此会带来不小开销，所以也是默认关闭的。</li><li><strong>慢查询日志（Slow Query Log）</strong>：记录执行时间过长和没有使用索引的查询语句（默认 10s），同时<strong>只会记录执行成功的语句</strong>。</li></ul>
              </div>
            </details>

<h2 id="Undo-Log如何保证事务的原子性"><a href="#Undo-Log如何保证事务的原子性" class="headerlink" title="Undo Log如何保证事务的原子性"></a>Undo Log如何保证事务的原子性<a id="undo"></a></h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>每当 InnoDB 引擎对一条记录进行操作（修改、删除、新增）时，要把回滚时需要的信息都记录到 undo log 里，比如：<ul><li>插入一条记录时，要把这条记录的主键值记下来，回滚时只需要把这个主键值对应的记录删掉即可</li><li>删除一条记录时，要把这条记录中的内容都记下来，回滚时把由这些内容组成的记录插入到表中</li><li>更新一条记录时，要把被更新的列的旧值记下来，回滚时把这些列更新为旧值</li></ul></li></ul>
              </div>
            </details>

<h2 id="Redo-Log如何保证事务的持久性"><a href="#Redo-Log如何保证事务的持久性" class="headerlink" title="Redo Log如何保证事务的持久性"></a>Redo Log如何保证事务的持久性<a id="redo"></a></h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>InnoDB 使用了一种叫做 <strong>Write-Ahead Logging (WAL)</strong> 的技术，Redo Log 是 WAL 的具体实现。</li><li><strong>工作原理</strong><ul><li><strong>事务执行时</strong>：<ul><li>当事务修改数据时，InnoDB 首先将修改操作记录到内存中的 <strong>Buffer Pool</strong>（缓冲池），而不是直接写到磁盘上的数据文件。</li><li>同时，这些修改会被记录到 <strong>Redo Log Buffer</strong>（重做日志缓冲区）中。</li></ul></li><li><strong>事务提交时</strong>：<ul><li>Redo Log Buffer 中的日志会被写入磁盘上的 <strong>Redo Log 文件</strong>（通常是 ib_logfile0 和 ib_logfile1）。</li><li>只有当 Redo Log 成功写入磁盘后，事务才算真正提交成功。</li><li>数据文件的实际修改（脏页刷新）可以延迟进行，由后台线程异步完成。</li></ul></li><li><strong>崩溃恢复时</strong>：<ul><li>如果系统在事务提交后但数据文件未更新前崩溃，InnoDB 会利用磁盘上的 Redo Log 重放已提交事务的修改，恢复数据到一致状态。</li></ul></li></ul></li></ul>
              </div>
            </details>

<h2 id="脏页什么时候刷盘"><a href="#脏页什么时候刷盘" class="headerlink" title="脏页什么时候刷盘"></a>脏页什么时候刷盘</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>当 redo log 日志满了的情况下，会主动触发脏页刷新到磁盘</li><li>Buffer Pool 空间不足时，需要将一部分数据页淘汰掉，如果淘汰的是脏页，需要先将脏页同步到磁盘</li><li>MySQL 认为空闲时，后台线程会定期将适量的脏页刷入到磁盘</li><li>MySQL 正常关闭之前，会把所有的脏页刷入到磁盘</li></ul>
              </div>
            </details>

<h2 id="Redo-Log什么时候刷盘"><a href="#Redo-Log什么时候刷盘" class="headerlink" title="Redo Log什么时候刷盘"></a>Redo Log什么时候刷盘</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>MySQL正常关闭时</li><li>Redo Log Buffer空间不足时</li><li>后台线程定期异步刷新</li><li>事务提交时（由 innodb_flush_log_at_trx_commit 参数控制，默认为1）<ul><li>参数为0时，不主动触发刷盘</li><li>参数为1时，每次事务提交时，Redo Log Buffer 中的日志立即写入磁盘</li><li>参数为2时，每次事务提交时，日志写入操作系统缓存，转由操作系统控制落盘时机</li></ul></li></ul>
              </div>
            </details>

<h2 id="Redo-Log和Bin-Log有什么不同"><a href="#Redo-Log和Bin-Log有什么不同" class="headerlink" title="Redo Log和Bin Log有什么不同"></a>Redo Log和Bin Log有什么不同</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>适用对象不同</strong><ul><li>Bin Log 是 MySQL的 Server 层实现的，所有存储引擎都可以使用</li><li>Redo Log 是lnnodb 存储引擎实现的日志</li></ul></li><li><strong>文件格式不同</strong><ul><li>Redo Log 是物理日志，记录的是在某个数据页做了什么修改，比如对 XXX 表空间中的 YYY 数据页 ZZZ 偏移量的地方做了AAA 更新</li><li>Bin Log有 3 种格式类型，分别是 STATEMENT（默认格式）、ROW、 MIXED<ul><li>STATEMENT：每一条修改数据的 SQL 都会被记录到 Bin Log 中（相当于记录了逻辑操作，所以针对这种格式， Bin Log 可以称为逻辑日志），主从复制中 slave 端再根据 SQL 语句重现。但 STATEMENT 有动态函数的问题，比如用了 uuid 或者 now 这些函数，在主库上执行的结果和在从库执行的结果不一致，这种随时在变的函数会导致复制的数据不一致</li><li>ROW：记录行数据最终被修改成什么样了（这种格式的日志，就不能称为逻辑日志了），不会出现 STATEMENT 下动态函数的问题。但 ROW 的缺点是每行数据的变化结果都会被记录，比如执行批量 update 语句，更新多少行数据就会产生多少条记录，使 binlog 文件过大，而在 STATEMENT 格式下只会记录一个 update 语句而已</li><li>MIXED：包含了 STATEMENT 和 ROW 模式，它会根据不同的情况自动使用 ROW 模式和 STATEMENT 模式</li></ul></li></ul></li><li><strong>写入方式不同</strong><ul><li>Bin Log 是追加写，写满一个文件，就创建一个新的文件继续写，不会覆盖以前的日志，保存的是全量的日志</li><li>Redo Log是循环写，日志空间大小固定，全部写满就从头开始</li></ul></li><li><strong>用途不同</strong><ul><li>Bin Log 用于备份恢复、主从复制</li><li>Redo Log 用于故障后的数据恢复</li></ul></li></ul>
              </div>
            </details>

<h2 id="Bin-Log什么时候刷盘"><a href="#Bin-Log什么时候刷盘" class="headerlink" title="Bin Log什么时候刷盘"></a>Bin Log什么时候刷盘</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <p>MySQL提供一个 sync_binlog 参数来控制数据库的 Bin Log 刷到磁盘上的频率</p><ul><li>sync_binlog &#x3D; 0 的时候，每次提交事务都只写入到操作系统缓存，后续交由操作系统决定何时将数据持久化到磁盘</li><li>sync_binlog &#x3D; 1 的时候，每次提交事务都会马上执行刷盘</li><li>sync_binlog &#x3D;N（N&gt;1） 的时候，累积 N 个事务后一起刷盘</li></ul>
              </div>
            </details>

<h2 id="两段提交"><a href="#两段提交" class="headerlink" title="两段提交"></a>两段提交</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>事务提交后，Redo Log 和 Bin Log 都要持久化到磁盘，但是这两个是独立的逻辑，可能出现半成功的状态，这样就造成两份日志之间的逻辑不一致，在主从架构中，两者无论是哪一个单独成功，最终都会导致主从不一致的问题，「两段提交」就是为应对该问题的解决方案，它可以保证多个逻辑操作要不全部成功，要不全部失败，不会出现半成功的状态。</li><li><strong>两段提交过程</strong><ul><li>Prepare阶段<ul><li>将 XID写入到 Redo Log，同时将 Redo Log 对应的事务状态设置为 prepare，然后将 Redo Log持久化到磁盘</li></ul></li><li>Commit阶段<ul><li>把 XID 写入到 Bin Log，然后将 Bin Log 持久化到磁盘，接着调用引擎的提交事务接口，将 Redo Log 状态设置为 commit</li></ul></li></ul></li><li>两段提交的核心点就是将Redo Log的写入拆分成两个阶段，以此确保确保 Redo Log 和 Bin Log 之间的顺序和一致性</li><li><strong>两段提交的问题</strong><ul><li>磁盘IO次数高：每次事务提交都要进行两次刷盘，一次是 redo log 刷盘，另一次是 binlog 刷盘</li><li>锁竞争激烈：在多事务的场景下，需要通过加锁来确保两个事务提交顺序一致</li></ul></li></ul>
              </div>
            </details>

<h1 id="进阶部分"><a href="#进阶部分" class="headerlink" title="进阶部分"></a>进阶部分</h1><h2 id="MySQL逻辑框架"><a href="#MySQL逻辑框架" class="headerlink" title="MySQL逻辑框架"></a>MySQL逻辑框架</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/post/mysql-framework.png"
                      alt="mysql-framework"
                ></p>
              </div>
            </details>

<h2 id="一条SQL语句的总体流程"><a href="#一条SQL语句的总体流程" class="headerlink" title="一条SQL语句的总体流程"></a>一条SQL语句的总体流程</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ol><li><strong>连接器</strong>：建立连接，管理连接、校验用户身份 </li><li><strong>查询缓存</strong>：查询语句如果命中查询缓存则直接返回，否则继续往下执行。MySQL 8.0 已删除该模块 </li><li><strong>分析器</strong>：通过解析器对 SQL 查询语句进行词法分析、语法分析，然后构建语法树，方便后续模块读取表名、字段、语句类型 </li><li><strong>优化器</strong>：决定使用哪个索引，或者在一个语句有多表关联（join）时，决定各个表的连接顺序，生成执行成本最小的执行计划 </li><li><strong>执行器</strong>：根据执行计划执行 SQL 查询语句，从存储引擎读取记录，返回给客户端</li></ol>
              </div>
            </details>

<h2 id="一条Update语句的具体执行流程"><a href="#一条Update语句的具体执行流程" class="headerlink" title="一条Update语句的具体执行流程"></a>一条Update语句的具体执行流程</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ol start="0"><li>连接器、分析器、优化器</li><li>执行器负责具体执行，会调用存储引擎的接口，通过主键索引树搜索获取要更新的记录<ul><li>如果记录所在的数据页就在 buffer pool 中，直接返回给执行器更新</li><li>如果记录不在 buffer pool，将数据页从磁盘读入到 buffer pool，返回记录给执行器</li></ul></li><li>执行器得到聚簇索引记录后，会检查更新前的记录和更新后的记录是否一样<ul><li>如果一样的话就不进行后续更新流程</li><li>如果不一样的话就把更新前的记录和更新后的记录都当作参数传给 InnoDB 层，让 InnoDB 真正的执行更新记录的操作</li></ul></li><li>开启事务， InnoDB 层更新记录前，首先需要把被更新的列的旧值记下来，生成一条 Undo Log，Undo Log 会写入 Buffer Pool 中的 Undo 页面</li><li>InnoDB在Buffer Pool中更新对应的数据页，并将该数据页标记为脏页，然后通过WAL技术，先写Redo Log，之后在合适的时机将脏页持久化到磁盘</li><li>然后开始记录该语句对应的Bin Log，也在合适的时机刷盘，默认是在事务提交时刷盘</li><li>事务提交阶段，两段提交</li><li>至此完成一条更新语句</li></ol>
              </div>
            </details>

<h2 id="MVCC是什么"><a href="#MVCC是什么" class="headerlink" title="MVCC是什么"></a>MVCC是什么</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>MVCC（Multi-Version Concurrency Control，多版本并发控制）是MySQL InnoDB 存储引擎用来提高并发性能并减少事务锁竞争的一种机制，它允许数据库同时存在多个版本的数据，实现读写不冲突，从而提升性能</li><li>主要通过Undo Log和<a href="#readview">Read View</a>来实现</li></ul>
              </div>
            </details>

<h2 id="SQL调优"><a href="#SQL调优" class="headerlink" title="SQL调优"></a>SQL调优</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>计数时尽量使用COUNT(1)或COUNT(*)</li><li>查询时尽量使用SELECT(明确字段)<ul><li>优化器解析<code>*</code>符号为所有列名要耗费时间，并且<code>*</code>号无法使用覆盖索引</li></ul></li><li>使用limit N，少用limit M，N，避免深度分页</li><li>尽量UNION ALL而不是UNION<ul><li>UNION ALL不去重，速度更快</li></ul></li></ul>
              </div>
            </details>

<h2 id="查询速度慢如何分析"><a href="#查询速度慢如何分析" class="headerlink" title="查询速度慢如何分析"></a>查询速度慢如何分析</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>分析查询语句</strong><ul><li>使用EXPLAIN命令分析SQL执行计划，找出慢查询的原因<ul><li>首先看 <strong>type</strong> 字段，避免出现 ALL（全表扫描）</li><li>检查 <strong>key</strong> 是否使用了预期的索引</li><li><strong>rows</strong> 值是否过大</li><li><strong>Extra</strong> 中是否有需要优化的警告</li><li>比较 <strong>possible_keys</strong> 和 <strong>key</strong> 是否一致</li></ul></li></ul></li><li>SQL<strong>优化角度</strong><ul><li><a href="#SQL%E8%B0%83%E4%BC%98">SQL调优</a></li></ul></li><li><strong>索引优化角度</strong><ul><li>创建或优化索引：根据查询条件创建合适的索引，特别是经常用于WHERE子句的字段、Orderby 排序的字段、Join 连表查询的字典、 group by的字段，并且如果查询中经常涉及多个字段，考虑创建联合索引，使用联合索引要符合最左匹配原则，不然会索引失效</li><li>避免索引失效：比如不要用左模糊匹配、函数计算、表达式计算等等。</li></ul></li><li><strong>数据库优化角度</strong><ul><li>优化数据库表<ul><li>如果单表的数据超过了千万级别，考虑是否需要将大表拆分为小表，减轻单个表的查询压力。</li><li>也可以将字段多的表分解成多个表，有些字段使用频率高，有些低，数据量大时，会由于使用频率低的存在而变慢，可以考虑分开。</li></ul></li><li>使用缓存技术<ul><li>引入缓存层，如Redis，存储热点数据和频繁查询的结果，但是要考虑缓存一致性的问题，对于读请求会选择旁路缓存策略，对于写请求会选择先更新 db，再删除缓存的策略。</li></ul></li></ul></li></ul>
              </div>
            </details>

<h2 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li>主从复制主要实现数据的备份、读写分离功能，主库负责写，从库负责读</li><li><strong>主从复制的原理</strong><ul><li>首先主库将表的变更写入binlog日志</li><li>然后从库连接到主库，通过IO线程将主库binlog日志拷贝到本地，写入到中继日志中</li><li>从库有一个sql线程会从中继日志读取binlog日志，相当于在本地再执行一遍SQL</li></ul></li><li><strong>主从复制的同步方式</strong><ul><li>同步复制<ul><li>MySQL 主库提交事务的线程等待所有从库的复制成功响应，才返回客户端结果</li><li>一般不使用这种方式，因为性能和可用性都比较差</li></ul></li><li>异步复制（默认）<ul><li>MySQL 主库提交事务的线程并不会等待 binlog 同步到各从库，就返回客户端结果。</li><li>这种模式一旦主库宕机，数据就会发生丢失。</li></ul></li><li>半同步复制<ul><li>MySQL 5.7 版本之后增加的一种复制方式，介于两者之间，事务线程不用等待所有的从库复制成功响应，只要一部分复制成功响应回来就行</li><li>这种半同步复制的方式，兼顾了异步复制和同步复制的优点，即使出现主库宕机，至少还有一个从库有最新的数据，不存在数据丢失的风险</li></ul></li></ul></li></ul>
              </div>
            </details>

<h2 id="为什么要分库分表"><a href="#为什么要分库分表" class="headerlink" title="为什么要分库分表"></a>为什么要分库分表</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <div class="tabs" id="tab-sixth"><ul class="nav-tabs"><li class="tab active"><a class="#sixth-1">分库</a></li><li class="tab"><a class="#sixth-2">分表</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sixth-1"><ul><li>为什么要分库<ul><li>磁盘容量有限</li><li>数据库的连接数有限，高并发场景下，会出现too many connections报错</li></ul></li><li>分库的好处<ul><li>解决了单库大数据，高并发的性能瓶颈</li><li>可以降低单机硬件资源的瓶颈</li></ul></li><li>分库的方式<ul><li>水平分库<ul><li>把同一个表的数据按一定规则拆到不同的数据库中，每个库可以放在不同的服务器上</li></ul></li><li>垂直分库<ul><li>将表按业务分类，然后分布在不同数据库，部署在不同服务器上</li></ul></li></ul></li></ul></div><div class="tab-pane" id="sixth-2"><ul><li>为什么要分表<ul><li>单表数据量太大，做了很多优化仍然无法提升效率</li><li>索引一般是B+树存储结构，B+树高度增高，查询会过慢</li></ul></li><li>分表的好处<ul><li>优化单一表数据量过大而产生的性能问题</li><li>避免IO争抢并减少锁表的几率</li></ul></li><li>分表的方式<ul><li>水平分表<ul><li>在同一个数据库内，把同一个表的数据按一定规则拆到多个表中</li></ul></li><li>垂直分表<ul><li>将一个表按照字段分成多表，每个表存储其中一部分字段</li></ul></li></ul></li></ul></div></div></div>
              </div>
            </details>

<h2 id="分库分表带来的问题"><a href="#分库分表带来的问题" class="headerlink" title="分库分表带来的问题"></a>分库分表带来的问题</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <ul><li><strong>事务一致性问题</strong><ul><li>由于分库分表把数据分布在不同库甚至不同服务器，不可避免会带来分布式事务问题。</li></ul></li><li><strong>跨节点关联查询</strong><ul><li>垂直分库后两张表的信息不在一个数据库，甚至不在一台服务器，也无法进行关联查询</li><li>可将原关联查询分为两次查询，第一次查询的结果集中找出关联数据id，然后根据id发起第二次请求得到关联数据，最后将获得到的数据进行拼装</li></ul></li><li><strong>跨节点分页排序</strong><ul><li>跨节点多库进行查询时，limit分页、order by排序等问题，就变得比较复杂了，需要先在不同的分片节点中将数据进行排序并返回，然后将不同分片返回的结果集进行汇总和再次排序</li></ul></li><li><strong>主键避重</strong><ul><li>在分库分表环境中，由于表中数据同时存在不同数据库中，主键值使用的自增长将无法使用，某个分区数据库生成的ID无法保证全局唯一，因此需要单独设计全局主键，以避免跨库主键重复问题</li></ul></li></ul>
              </div>
            </details>

<h2 id="分布式事务的解决方案"><a href="#分布式事务的解决方案" class="headerlink" title="分布式事务的解决方案"></a>分布式事务的解决方案</h2><details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Answer </summary>
              <div class='content'>
              <blockquote><p><strong>强一致性方案</strong></p></blockquote><div class="tabs" id="tab-seventh"><ul class="nav-tabs"><li class="tab active"><a class="#seventh-1">2PC</a></li><li class="tab"><a class="#seventh-2">3PC</a></li></ul><div class="tab-content"><div class="tab-pane active" id="seventh-1"><p>2PC偏向于在数据库层面解决事务一致性问题，它将事务分为准备阶段和提交阶段，并由一个协调者来控制</p><ul><li><strong>工作流程</strong><ul><li><strong>Prepare</strong>：协调者向所有参与者发送准备请求，参与者收到消息后执行本地事务并将结果返回给协调者，但是不提交事务</li><li><strong>Commit</strong>：协调者根据所有参与者的返回结果决定是否提交事务。如果所有参与者都返回成功，协调者向所有参与者发送Commit指令，否则发送Rollback指令</li></ul></li><li><strong>优点</strong><ul><li>实现简单，很多事务都原生支持2PC，一般是基于XA协议</li><li>保证了数据的强一致性</li></ul></li><li><strong>缺点</strong><ul><li><strong>同步阻塞</strong>：在准备阶段后，所有参与者都锁定了相关资源，直到收到第二阶段指令，这段时间资源无法被其他事务访问，性能较差</li><li><strong>单点故障</strong>：如果协调者发生故障，所有参与者将一直处于锁定状态，无法完成事务提交</li></ul></li></ul></div><div class="tab-pane" id="seventh-2"><p>为了解决2PC的同步阻塞和单点问题，引入了3PC。它在2PC的基础上增加了超时机制，并将准备阶段一分为二。</p><ul><li><strong>工作流程</strong><ul><li><strong>CanCommit</strong>：询问参与者是否具备执行事务的条件（不锁定资源），类似于预检查。</li><li><strong>PreCommit</strong>：类似于2PC的准备阶段，执行操作但不提交，并记录日志。</li><li><strong>DoCommit</strong>：进行最终的提交或回滚。</li></ul></li><li><strong>优点</strong><ul><li>降低了参与者的阻塞时间，提高了系统的并发性能</li><li>通过超时自动提交机制，一定程度解决了单点故障的问题</li></ul></li><li><strong>缺点</strong><ul><li>因为引入超时机制，实现上更加复杂</li><li>不能完全保证数据一致性，极端情况下可能出现部分提交部分回滚的情况</li></ul></li></ul></div></div></div><blockquote><p><strong>最终一致性方案</strong></p></blockquote><div class="tabs" id="tab-eighth"><ul class="nav-tabs"><li class="tab active"><a class="#eighth-1">TCC</a></li><li class="tab"><a class="#eighth-2">Saga</a></li><li class="tab"><a class="#eighth-3">本地消息表</a></li><li class="tab"><a class="#eighth-4">消息事务</a></li></ul><div class="tab-content"><div class="tab-pane active" id="eighth-1"><p>TCC是一种在业务层面解决分布式事务一致性的方案，它将事务分为Try、Confirm、Cancel三个阶段</p><ul><li><strong>工作流程</strong><ul><li><strong>Try</strong>：完成所有业务的检查和预留资源</li><li><strong>Confirm</strong>：确认资源并执行和提交事务</li><li><strong>Cancel</strong>：执行失败时释放资源并进行回滚</li></ul></li><li><strong>优点</strong><ul><li>灵活性高，可以根据业务自定义资源锁定和释放的逻辑</li><li>避免了长时间的资源锁定，性能较好</li></ul></li><li><strong>缺点</strong><ul><li>业务侵入性强，需要为每个业务操作设计Try&#x2F;Confirm&#x2F;Cancel三个接口，开发和维护成本高</li></ul></li></ul></div><div class="tab-pane" id="eighth-2"><p>Saga模式适用于长事务场景，它将一个大事务拆分为一系列本地小事务（子事务），每个子事务都有对应的补偿动作</p><ul><li><strong>工作流程</strong><ul><li>依次执行预设的子事务，每个子事务执行成功后，记录下执行结果</li><li>如果某个子事务执行失败，逆序执行之前所有已成功子事务的补偿动作</li></ul></li><li><strong>优点</strong><ul><li>业务侵入性低，只需要实现补偿动作</li><li>性能较高，避免了资源长时间锁定</li></ul></li><li><strong>缺点</strong><ul><li>补偿动作失败可能会导致数据不一致，需要设计合理的重试机制</li></ul></li></ul></div><div class="tab-pane" id="eighth-3"><p>主要利用本地事务和消息队列来保证数据一致</p><ul><li><strong>工作流程</strong><ul><li>将业务和消息存放在同一个数据库中，利用本地事务保证原子性</li><li>有一个后台任务定时轮询消息表，将未发送的消息发送给mq</li><li>mq通知下游服务，下游服务消费成功后确认消息，失败则重试</li></ul></li><li><strong>优点</strong><ul><li>实现简单，业务之间能解偶</li><li>利用消息队列的重试机制，确保消息一定可达，可靠性高</li></ul></li><li><strong>缺点</strong><ul><li>消息与业务数据耦合在同一数据库中，可能成为性能瓶颈</li><li>依赖轮询任务，实时性较差</li></ul></li></ul></div><div class="tab-pane" id="eighth-4"><p>这是对本地消息表方案的优化和升级，由消息中间件直接提供分布式事务支持。</p><ul><li><strong>工作流程</strong><ul><li>生产者先向mq发送一条半事务消息，然后执行本地事务</li><li>生产者根据本地事务的执行情况，向mq发送确认或回滚消息</li><li>确认之后，mq将消息发送给下游服务进行消费，失败则重试</li></ul></li><li><strong>优点</strong><ul><li>在本地消息表的基础上，解决了业务数据和消息耦合存储的问题</li></ul></li><li><strong>缺点</strong><ul><li>更加依赖消息队列的可靠性，对消息队列要求较高</li></ul></li></ul></div></div></div>
              </div>
            </details>


		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> MySQL 面试题</li>
        <li><strong>Author:</strong> Lu Xiao</li>
        <li><strong>Created at
                :</strong> 2025-02-05 Wednesday</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-09-07 Sunday
            </li>
        
        <li>
            <strong>Link:</strong> https://hespecial.github.io/Interview/mysql-interview/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Interview/">#Interview</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/Interview/redis-interview/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Redis 面试题</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/Interview/go-interview/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Go 面试题</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">MySQL 面试题</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86"><span class="nav-number">1.</span> <span class="nav-text">基础部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.</span> <span class="nav-text">MySQL数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CHAR%E5%92%8CVARCHAR%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.2.</span> <span class="nav-text">CHAR和VARCHAR的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DATETIME-%E5%92%8C-TIMESTAMP-%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.3.</span> <span class="nav-text">DATETIME 和 TIMESTAMP 的区别是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F"><span class="nav-number">1.4.</span> <span class="nav-text">三大范式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INT-n-%E4%B8%AD%E7%9A%84n%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3"><span class="nav-number">1.5.</span> <span class="nav-text">INT(n)中的n如何理解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">2.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="nav-number">2.1.</span> <span class="nav-text">事务的特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">2.2.</span> <span class="nav-text">并发事务的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">2.3.</span> <span class="nav-text">事务的隔离级别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="nav-number">2.4.</span> <span class="nav-text">四种隔离级别是如何实现的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Read-View%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="nav-number">2.5.</span> <span class="nav-text">Read View的实现原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="nav-number">2.6.</span> <span class="nav-text">事务是如何实现的</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">3.</span> <span class="nav-text">存储引擎</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">3.1.</span> <span class="nav-text">如何选择存储引擎</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#InnoDB%E5%92%8CMyISAM%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">3.2.</span> <span class="nav-text">InnoDB和MyISAM的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96InnoDB%E7%9A%84%E6%80%A7%E8%83%BD"><span class="nav-number">3.3.</span> <span class="nav-text">如何优化InnoDB的性能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88InnoDB%E5%9C%A8%E5%B9%B6%E5%8F%91%E5%86%99%E5%85%A5%E6%97%B6%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD"><span class="nav-number">3.4.</span> <span class="nav-text">为什么InnoDB在并发写入时性能更好</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">4.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">4.1.</span> <span class="nav-text">索引的分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-number">4.2.</span> <span class="nav-text">索引的优缺点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-number">4.3.</span> <span class="nav-text">索引的设计原则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B%E6%A0%91%E5%92%8CB-%E6%A0%91%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.4.</span> <span class="nav-text">B树和B+树的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E6%A0%91%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%94B%E6%A0%91%E6%9B%B4%E9%80%82%E5%90%88%E7%94%A8%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95"><span class="nav-number">4.5.</span> <span class="nav-text">B+树为什么比B树更适合用与数据库索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E6%A0%91%E7%9B%B8%E5%AF%B9%E4%BA%8E%E4%BA%8C%E5%8F%89%E6%A0%91%E5%92%8CHash%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="nav-number">4.6.</span> <span class="nav-text">B+树相对于二叉树和Hash的优势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E6%A0%91%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-number">4.7.</span> <span class="nav-text">B+树查询数据的过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99"><span class="nav-number">4.8.</span> <span class="nav-text">最左匹配原则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%92%8C%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="nav-number">4.9.</span> <span class="nav-text">回表查询和覆盖索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95"><span class="nav-number">4.10.</span> <span class="nav-text">前缀索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8"><span class="nav-number">4.11.</span> <span class="nav-text">索引下推</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-number">4.12.</span> <span class="nav-text">索引失效的情况</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96"><span class="nav-number">4.13.</span> <span class="nav-text">索引优化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%94%81"><span class="nav-number">5.</span> <span class="nav-text">锁</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E9%94%81%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.1.</span> <span class="nav-text">MySQL锁的类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E6%98%AF%E5%A6%82%E4%BD%95%E5%8A%A0%E8%A1%8C%E7%BA%A7%E9%94%81%E7%9A%84"><span class="nav-number">5.2.</span> <span class="nav-text">MySQL是如何加行级锁的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E6%AD%BB%E9%94%81"><span class="nav-number">5.3.</span> <span class="nav-text">MySQL死锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81"><span class="nav-number">5.4.</span> <span class="nav-text">乐观锁和悲观锁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A5%E5%BF%97"><span class="nav-number">6.</span> <span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E6%97%A5%E5%BF%97"><span class="nav-number">6.1.</span> <span class="nav-text">MySQL中常见的日志</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Undo-Log%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="nav-number">6.2.</span> <span class="nav-text">Undo Log如何保证事务的原子性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redo-Log%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7"><span class="nav-number">6.3.</span> <span class="nav-text">Redo Log如何保证事务的持久性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%84%8F%E9%A1%B5%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%B7%E7%9B%98"><span class="nav-number">6.4.</span> <span class="nav-text">脏页什么时候刷盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redo-Log%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%B7%E7%9B%98"><span class="nav-number">6.5.</span> <span class="nav-text">Redo Log什么时候刷盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redo-Log%E5%92%8CBin-Log%E6%9C%89%E4%BB%80%E4%B9%88%E4%B8%8D%E5%90%8C"><span class="nav-number">6.6.</span> <span class="nav-text">Redo Log和Bin Log有什么不同</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bin-Log%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%B7%E7%9B%98"><span class="nav-number">6.7.</span> <span class="nav-text">Bin Log什么时候刷盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%A4%E6%AE%B5%E6%8F%90%E4%BA%A4"><span class="nav-number">6.8.</span> <span class="nav-text">两段提交</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6%E9%83%A8%E5%88%86"><span class="nav-number">7.</span> <span class="nav-text">进阶部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E9%80%BB%E8%BE%91%E6%A1%86%E6%9E%B6"><span class="nav-number">7.1.</span> <span class="nav-text">MySQL逻辑框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E6%9D%A1SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%80%BB%E4%BD%93%E6%B5%81%E7%A8%8B"><span class="nav-number">7.2.</span> <span class="nav-text">一条SQL语句的总体流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E6%9D%A1Update%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%85%B7%E4%BD%93%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">7.3.</span> <span class="nav-text">一条Update语句的具体执行流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MVCC%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">7.4.</span> <span class="nav-text">MVCC是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E8%B0%83%E4%BC%98"><span class="nav-number">7.5.</span> <span class="nav-text">SQL调优</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E9%80%9F%E5%BA%A6%E6%85%A2%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90"><span class="nav-number">7.6.</span> <span class="nav-text">查询速度慢如何分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="nav-number">7.7.</span> <span class="nav-text">主从复制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="nav-number">7.8.</span> <span class="nav-text">为什么要分库分表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">7.9.</span> <span class="nav-text">分库分表带来的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">7.10.</span> <span class="nav-text">分布式事务的解决方案</span></a></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Lu Xiao</a>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="fa-regular fa-arrow-up"></i>
		</li>
		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>






    
<script src="/js/build/libs/minimasonry.min.js"></script>

    
<script src="/js/build/plugins/masonry.js" type="module"></script>







    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>



    
<script src="/js/build/libs/pangu.min.js"></script>

<script src="/js/build/plugins/pangu.js"></script>




	
</body>

</html>